<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planificateur Retraite</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä Planificateur Retraite</h1>
            <p>Optimisez votre strat√©gie de retraite en quelques clics</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('client-info')">üë• Informations Client</button>
            <button class="tab" onclick="switchTab('finances')">üí∞ Situation Financi√®re</button>
            <button class="tab" onclick="switchTab('simulation')">üí∏ Gestion des Sorties</button>
            <button class="tab" onclick="switchTab('projection')">üìä Projection & Strat√©gie</button>
        </div>

        <!-- Onglet 1: Informations Client -->
        <div id="client-info" class="tab-content active">
            <div class="couple-toggle">
                <span>Personne seule</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="coupleToggle" onchange="toggleCouple()">
                    <span class="slider"></span>
                </label>
                <span>Couple</span>
            </div>

            <div class="client-sections" id="clientSections">
                <div class="client-section">
                    <h4>üë§ Client Principal</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="nom1">Nom</label>
                            <input type="text" id="nom1" placeholder="Nom de famille">
                        </div>
                        <div class="form-group">
                            <label for="prenom1">Pr√©nom</label>
                            <input type="text" id="prenom1" placeholder="Pr√©nom">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="age1">√Çge actuel</label>
                            <input type="number" id="age1" min="18" max="100" placeholder="35">
                        </div>
                        <div class="form-group">
                            <label for="dateRetraite1">Date de d√©part √† la retraite</label>
                            <input type="date" id="dateRetraite1" onchange="calculateTimeToRetirement(1)">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="revenus1">Revenus nets actuels (‚Ç¨/mois)</label>
                            <input type="number" id="revenus1" placeholder="3500" class="euro">
                        </div>
                        <div class="form-group">
                            <label for="revenusRetraite1">Revenus nets pr√©vus √† la retraite (‚Ç¨/mois)</label>
                            <input type="number" id="revenusRetraite1" placeholder="2100" class="euro">
                        </div>
                    </div>
                    <div id="tempsRestant1" class="warning-box" style="display: none;">
                        <strong>‚è∞ Temps restant avant la retraite : </strong><span id="dureeRetraite1"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Onglet 2: Situation Financi√®re -->
        <div id="finances" class="tab-content">
            <div class="form-section">
                <h3>üí≥ Situation Financi√®re Actuelle</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="liquidites">Liquidit√©s disponibles (‚Ç¨)</label>
                        <input type="number" id="liquidites" placeholder="25000" class="euro">
                    </div>
                    <div class="form-group">
                        <label for="parts">Nombre de parts fiscales</label>
                        <input type="number" id="parts" step="0.5" placeholder="2.5">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="revenusAutres">Autres revenus (fonciers, etc.) ‚Ç¨/mois</label>
                        <input type="number" id="revenusAutres" placeholder="800" class="euro">
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h3>üìä Charges Mensuelles</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="trainVie">Train de vie (‚Ç¨/mois)</label>
                        <input type="number" id="trainVie" placeholder="2800" class="euro">
                    </div>
                    <div class="form-group">
                        <label for="impotInfo">Imp√¥ts (calcul√©s automatiquement)</label>
                        <input type="text" value="Calcul automatique bas√© sur vos revenus" readonly style="background: #f8f9fa; font-style: italic;">
                    </div>
                </div>
                
                <div id="credits-section">
                    <h4>üè† Cr√©dits en cours</h4>
                    <div id="creditsList">
                        <div class="contract-item">
                            <div class="form-group">
                                <label>Type de cr√©dit</label>
                                <select>
                                    <option>Immobilier</option>
                                    <option>Consommation</option>
                                    <option>Auto</option>
                                    <option>Autre</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Mensualit√© (‚Ç¨)</label>
                                <input type="number" placeholder="1200" class="euro">
                            </div>
                            <div class="form-group">
                                <label>Date de fin</label>
                                <input type="date">
                            </div>
                        </div>
                    </div>
                    <button class="add-contract-btn" onclick="addCredit()">‚ûï Ajouter un cr√©dit</button>
                </div>

                <button class="calculate-btn" onclick="calculateBudget()">üßÆ Calculer le d√©ficit retraite</button>
                <div id="budgetResult" class="result-box">
                    <h4>üí° Analyse Budg√©taire</h4>
                    <p id="deficitText"></p>
                </div>
            </div>
        </div>

        <!-- Onglet 3: Gestion des Sorties -->
        <div id="simulation" class="tab-content">
            <div class="form-section">
                <h3>üíº Gestion des Contrats et Sorties</h3>
                <p style="background: #e8f4fd; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <strong>üí° Objectif :</strong> Calculez les frais de sortie de vos contrats pour combler le d√©ficit identifi√© dans l'onglet pr√©c√©dent.
                </p>
                
                <div id="deficitRecap" style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 25px; display: none;">
                    <h5 style="color: #856404; margin-bottom: 10px;">üéØ Rappel du D√©ficit √† Combler</h5>
                    <p id="deficitAmount" style="margin: 0; font-size: 1.1em;"></p>
                </div>
                
                <div class="contracts-management">
                    <h4 style="color: #2c3e50; margin-bottom: 20px;">üìã Contrats Financiers D√©taill√©s</h4>
                    <div id="contractsManagementList">
                        <div class="contract-management-item">
                            <div class="contract-header">
                                <div class="form-group">
                                    <label>Nom du contrat</label>
                                    <input type="text" placeholder="Ex: AV Cr√©dit Agricole - Predica" style="font-weight: 600;">
                                </div>
                                <div class="form-group">
                                    <label>Type</label>
                                    <select onchange="updateContractType(this)">
                                        <option>Assurance Vie</option>
                                        <option>PER</option>
                                        <option>Capitalisation</option>
                                        <option>FCPI</option>
                                        <option>SCPI</option>
                                        <option>Actions</option>
                                        <option>Autre</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Montant (‚Ç¨)</label>
                                    <input type="number" placeholder="85000" class="euro" onchange="updateContractCalculations(this)">
                                </div>
                            </div>
                            
                            <div class="contract-details">
                                <h6 style="color: #495057; margin-bottom: 15px;">üßæ Fiscalit√© et Sortie</h6>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 15px;">
                                    <div class="form-group">
                                        <label>IR sur plus-values (%)</label>
                                        <input type="number" step="0.1" placeholder="12.8" class="percentage" onchange="updateContractCalculations(this)">
                                    </div>
                                    <div class="form-group">
                                        <label>Pr√©l√®vements Sociaux (%)</label>
                                        <input type="number" step="0.1" placeholder="17.2" class="percentage" onchange="updateContractCalculations(this)">
                                    </div>
                                    <div class="form-group">
                                        <label>Exon√©ration IR</label>
                                        <select onchange="toggleIRExemption(this)">
                                            <option value="non">Non</option>
                                            <option value="oui">Oui (>8 ans, etc.)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Exon√©ration PS</label>
                                        <select onchange="updateContractCalculations(this)">
                                            <option value="non">Non</option>
                                            <option value="oui">Oui</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 15px;">
                                    <div class="form-group">
                                        <label>Plus-value estim√©e (‚Ç¨)</label>
                                        <input type="number" placeholder="15000" class="euro" onchange="updateContractCalculations(this)">
                                    </div>
                                    <div class="form-group">
                                        <label>Type de sortie</label>
                                        <select onchange="updateContractCalculations(this)">
                                            <option>Capital</option>
                                            <option>Rente</option>
                                            <option>Mixte</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label style="font-weight: bold; color: #d63384;">Sortir ce contrat ?</label>
                                        <select onchange="toggleContractExit(this)" style="border: 2px solid #d63384;">
                                            <option value="non">‚ùå Non</option>
                                            <option value="oui">‚úÖ Oui</option>
                                        </select>
                                    </div>
                                    <div class="contract-fees" style="background: #f8f9fa; padding: 10px; border-radius: 6px; text-align: center;">
                                        <small style="color: #6c757d;">Frais de sortie</small><br>
                                        <strong class="fees-amount" style="color: #dc3545;">0 ‚Ç¨</strong>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button class="add-contract-btn" onclick="addManagementContract()">‚ûï Ajouter un contrat</button>
                </div>
                
                <div style="margin-top: 30px;">
                    <button class="calculate-btn" onclick="calculateExitFees()">üí∞ Calculer les frais totaux de sortie</button>
                    
                    <div id="exitFeesResult" class="result-box">
                        <h4>üí∏ Estimation des Frais de Sortie</h4>
                        <div id="feesBreakdown"></div>
                        <div id="netAmountAvailable"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Onglet 4: Projection & Strat√©gie -->
        <div id="projection" class="tab-content">
            <div class="form-section">
                <h3>üéØ Strat√©gie de Comblement du D√©ficit</h3>
                <p style="background: #e8f4fd; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <strong>üí° Objectif :</strong> Utilisez l'argent r√©cup√©r√© des contrats pour combler le d√©ficit mensuel identifi√©. 
                    Les contrats sortis en rente sont prioritaires, les capitaux servent de compl√©ment ou de replacement.
                </p>
                
                <!-- R√©capitulatif des donn√©es pr√©c√©dentes -->
                <div id="dataRecap" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div style="background: #ffebee; padding: 20px; border-radius: 10px; border-left: 5px solid #f44336;">
                        <h5 style="color: #c62828; margin-bottom: 10px;">üéØ D√©ficit √† Combler</h5>
                        <div id="deficitProjection" style="font-size: 1.3em; font-weight: bold; color: #d32f2f;">
                            Calculez d'abord votre d√©ficit dans l'onglet "Situation Financi√®re"
                        </div>
                    </div>
                    <div style="background: #e8f5e8; padding: 20px; border-radius: 10px; border-left: 5px solid #4caf50;">
                        <h5 style="color: #2e7d32; margin-bottom: 10px;">üí∞ Capital Disponible</h5>
                        <div id="capitalProjection" style="font-size: 1.3em; font-weight: bold; color: #388e3c;">
                            Simulez vos sorties dans l'onglet "Gestion des Sorties"
                        </div>
                    </div>
                    <div style="background: #fff3e0; padding: 20px; border-radius: 10px; border-left: 5px solid #ff9800;">
                        <h5 style="color: #f57c00; margin-bottom: 10px;">üìà Revenus de Rentes</h5>
                        <div id="rentesProjection" style="font-size: 1.3em; font-weight: bold; color: #ef6c00;">
                            0 ‚Ç¨ / mois
                        </div>
                    </div>
                </div>

                <!-- Configuration de la strat√©gie -->
                <div style="background: #f8f9fa; padding: 25px; border-radius: 10px; margin-bottom: 25px;">
                    <h4 style="color: #2c3e50; margin-bottom: 20px;">‚öôÔ∏è Param√®tres de Projection</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                        <div class="form-group">
                            <label for="rendementReplacement">Rendement contrats de replacement (%/an)</label>
                            <input type="number" id="rendementReplacement" step="0.1" value="3.5" placeholder="3.5">
                        </div>
                        <div class="form-group">
                            <label for="inflationRate">Taux d'inflation (%/an)</label>
                            <input type="number" id="inflationRate" step="0.1" value="2.0" placeholder="2.0">
                        </div>
                        <div class="form-group">
                            <label for="ageEsperanceVie">Esp√©rance de vie (ann√©es)</label>
                            <input type="number" id="ageEsperanceVie" value="85" placeholder="85">
                        </div>
                    </div>
                </div>

                <button class="calculate-btn" onclick="calculateProjection()">üöÄ Calculer la Projection</button>
                
                <!-- R√©sultats de la projection -->
                <div id="projectionResult" class="result-box">
                    <h4>üìä Projection de Comblement du D√©ficit</h4>
                    
                    <!-- R√©sum√© de la strat√©gie -->
                    <div id="strategyOverview" style="margin-bottom: 25px;"></div>
                    
                    <!-- Tableau de projection -->
                    <div id="projectionTable" style="margin-bottom: 25px;"></div>
                    
                    <!-- Recommandations -->
                    <div id="recommendations" style="margin-bottom: 25px;"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="main.js"></script>
</body>
</html>
